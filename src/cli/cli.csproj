<Project Sdk="Microsoft.NET.Sdk">
    <PropertyGroup>
        <ApplicationIcon>..\..\Flare.ico</ApplicationIcon>
        <AssemblyName>flare</AssemblyName>
        <IncludeSource>false</IncludeSource>
        <IsPackable>true</IsPackable>
        <IsPublishable>true</IsPublishable>
        <OutputType>Exe</OutputType>
        <PackAsTool>true</PackAsTool>
        <RootNamespace>Flare.Cli</RootNamespace>
        <ServerGarbageCollection>true</ServerGarbageCollection>
        <TargetFramework>net5.0</TargetFramework>
    </PropertyGroup>

    <ItemGroup>
        <InternalsVisibleTo Include="flare-tests.TestAdapter" />
    </ItemGroup>

    <ItemGroup>
        <None Include="..\..\LICENSE.md; ..\..\README.md">
            <Pack>true</Pack>
            <PackagePath>%(Filename)%(Extension)</PackagePath>
            <Visible>true</Visible>
        </None>
    </ItemGroup>

    <ItemGroup>
        <ProjectReference Include="..\lib\lib.csproj" />
    </ItemGroup>

    <ItemGroup>
        <PackageReference Include="Nett">
            <Version>$(NettVersion)</Version>
        </PackageReference>
        <PackageReference Include="NuGet.Versioning">
            <Version>$(NuGetVersioningVersion)</Version>
        </PackageReference>
        <PackageReference Include="ReadLine">
            <Version>$(ReadLineVersion)</Version>
        </PackageReference>
        <PackageReference Include="System.CommandLine.Rendering">
            <Version>$(SystemCommandLineRenderingVersion)</Version>
        </PackageReference>
    </ItemGroup>

    <Target AfterTargets="Publish" Condition="'$(PublishSingleFile)' == 'true'" Name="ZipSingleFile">
        <ZipDirectory DestinationFile="$(PublishDir)..\$(Product).$(Version).$(RuntimeIdentifier).zip" Overwrite="true" SourceDirectory="$(PublishDir)" />
    </Target>
</Project>
